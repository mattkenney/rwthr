var weatherApp=angular.module("weatherApp",["ui.bootstrap","ngResource","ngRoute"]);weatherApp.config(["$routeProvider",function(a){a.when("/radar",{templateUrl:"partials/forecast.html",controller:"RadarCtrl"}).when("/fiveday",{templateUrl:"partials/forecast.html",controller:"FiveDayCtrl"}).when("/atlantic",{templateUrl:"partials/forecast.html",controller:"AtlanticCtrl"}).when("/pacific",{templateUrl:"partials/forecast.html",controller:"PacificCtrl"}).when("/where",{templateUrl:"partials/where.html",controller:"WhereCtrl"}).when("/about",{templateUrl:"partials/about.html"}).otherwise({redirectTo:"/radar"})}]),weatherApp.controller("AtlanticCtrl",["$scope",function(a){a.image={alt:"Atlantic outlook",classname:"mw-tropic",src:"http://www.nhc.noaa.gov/tafb_latest/danger_atl_latestBW_sm2.gif"}}]),weatherApp.controller("FiveDayCtrl",["$scope",function(a){a.image={alt:"5 Day",classname:"mw-graph",src:a.graph.url}}]),weatherApp.controller("NavBarCtrl",["$scope","$location","$window",function(a,b,c){var d=!0,e=function(){a.navBar.div={"navbar-collapse":!0,collapse:!!d}};if(a.navBar={li:function(a){return b.path()==a?"active":""},toggle:function(a){d=a===!1||(a===!0?!1:!d),e()}},e(),c.ga){var f;a.$on("$routeChangeSuccess",function(){var a=b.path();f!==a&&(f=a,c.ga("send","pageview",a))})}}]),weatherApp.controller("PacificCtrl",["$scope",function(a){a.image={alt:"Pacific outlook",classname:"mw-tropic",src:"http://www.nhc.noaa.gov/tafb_latest/danger_pac_latestBW_sm2.gif"}}]),weatherApp.controller("RadarCtrl",["$scope",function(a){a.image={alt:"Radar",classname:"mw-radar",src:a.radar}}]),weatherApp.controller("WeatherCtrl",["$scope","$resource",function(a,b){a.move=function(c){var d={},e="/api/radar";c&&c.lat&&c.lon&&(d.lat=c.lat,d.lon=c.lon,e+="?lat="+encodeURIComponent(c.lat),e+="&lon="+encodeURIComponent(c.lon)),a.place=b("/api/place").get(d),a.observation=b("/api/observation").get(d),a.range=b("/api/range").get(d),a.graph=b("/api/graph").get(d),a.radar=e},a.locate=function(){function b(b){b&&b.coords&&a.$apply(function(){a.move({lat:b.coords.latitude,lon:b.coords.longitude})})}if(a.move(),navigator.geolocation){var c={maximumAge:18e5,timeout:5e3};navigator.geolocation.getCurrentPosition(b,null,c)}},a.locate()}]),weatherApp.controller("WhereCtrl",["$scope","$http","$location","$window",function(a,b,c,d){function e(a){if(a&&a.name){for(var b=0;b<f.length;b++)if(a.name===f[b].name){f.splice(b,1);break}f.push(a),f.length>5&&f.shift(),d.localStorage&&d.localStorage.setItem("WhereCtrl.recent",JSON.stringify(f))}}var f=[];if(d.localStorage){var g=d.localStorage.getItem("WhereCtrl.recent");g&&(f=JSON.parse(g))}a.recent=function(){var a=f.slice();return a.sort(function(a,b){return a.name<b.name?-1:a.name>b.name?1:0}),a},a.search=function(a){return a&&a.length?b.get("/api/search?q="+encodeURIComponent(a)).then(function(a){return a.data.places}):void 0},a.choose=function(b){e(b),a.move(b),c.path("/radar")}}]);